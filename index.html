<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>张弛虚拟形象创建与互动游戏</title>
<style>
    body {
        margin: 0;
        padding: 0;
        background: #1c1c1c;
        font-family: "Microsoft YaHei", sans-serif;
        color: #fff;
    }

    /* 基础布局 */
    .container {
        display: flex;
        flex-direction: row;
        height: 100vh;
        overflow: hidden;
    }

    /* 左侧工具栏 */
    .sidebar {
        width: 320px;
        background: #2d2d2d;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #444;
        overflow-y: auto;
        padding: 20px;
        box-sizing: border-box;
    }

    .sidebar h2 {
        margin-top: 0;
        font-size: 24px;
        text-align: center;
        padding-bottom: 10px;
        border-bottom: 1px solid #444;
    }

    .option-group {
        margin-bottom: 20px;
    }

    .option-group h3 {
        font-size: 18px;
        margin: 10px 0 5px 0;
    }

    .option-group label {
        display: block;
        margin: 6px 0;
        font-size: 14px;
    }

    .option-group select,
    .option-group input[type="range"],
    .option-group input[type="text"],
    .option-group input[type="number"],
    .option-group textarea {
        width: 100%;
        padding: 4px;
        margin-top: 2px;
        background: #3d3d3d;
        border: 1px solid #555;
        color: #fff;
        font-size: 14px;
        box-sizing: border-box;
    }

    .option-group button {
        background: #5a9b5f;
        border: none;
        padding: 10px;
        font-size: 14px;
        color: #fff;
        cursor: pointer;
        margin-top: 10px;
        width: 100%;
    }

    .option-group button:hover {
        background: #6eb374;
    }

    /* 中间主区域 */
    .main-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: #1c1c1c;
    }

    .top-bar {
        background: #333;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .top-bar .logo {
        font-size: 20px;
    }

    .top-bar .actions button {
        background: none;
        border: 1px solid #555;
        color: #fff;
        margin-left: 8px;
        padding: 6px 12px;
        cursor: pointer;
    }

    .top-bar .actions button:hover {
        background: #444;
    }

    .scene {
        flex: 1;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #111;
    }

    .character-preview {
        position: relative;
        width: 300px;
        height: 600px;
        background: #222;
        border: 2px solid #444;
        border-radius: 10px;
        overflow: hidden;
    }

    /* 虚拟形象的各部件（简单示例，可扩展） */
    .character-part {
        position: absolute;
        width: 100%;
        height: 100%;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
    }

    /* 右下角状态栏 */
    .status-bar {
        background: #333;
        height: 120px;
        border-top: 1px solid #444;
        display: flex;
        padding: 10px;
        box-sizing: border-box;
    }

    .status-item {
        flex: 1;
        margin: 0 5px;
        background: #2d2d2d;
        border: 1px solid #444;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .status-item h4 {
        margin: 0;
        font-size: 14px;
        padding-bottom: 5px;
        border-bottom: 1px solid #444;
        width: 100%;
        text-align: center;
    }

    .status-value {
        font-size: 16px;
        margin-top: 5px;
    }

    /* 滑块的样式 */
    input[type="range"] {
        -webkit-appearance: none;
        height: 6px;
        background: #444;
        border-radius: 3px;
        outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 14px;
        height: 14px;
        background: #5a9b5f;
        border-radius: 50%;
        cursor: pointer;
    }

    /* 滚动条样式 */
    ::-webkit-scrollbar {
        width: 8px;
    }
    ::-webkit-scrollbar-track {
        background: #2d2d2d;
    }
    ::-webkit-scrollbar-thumb {
        background: #444;
    }
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
</style>
</head>
<body>

<div class="container">
    <!-- 左侧自定义选项栏 -->
    <div class="sidebar">
        <h2>角色定制</h2>
        
        <div class="option-group">
            <h3>基本信息</h3>
            <label>
                姓名（固定）:
                <input type="text" id="charName" value="张弛" readonly/>
            </label>
            <label>
                昵称（可选）:
                <input type="text" id="charNickname" placeholder="为张弛取个别名..."/>
            </label>
            <label>
                年龄:
                <input type="number" id="charAge" min="18" max="60" value="25"/>
            </label>
            <label>
                身高(cm):
                <input type="number" id="charHeight" min="150" max="210" value="175"/>
            </label>
            <label>
                体重(kg):
                <input type="number" id="charWeight" min="50" max="120" value="68"/>
            </label>
        </div>

        <div class="option-group">
            <h3>面部定制</h3>
            <label>
                肤色:
                <select id="charSkinColor">
                    <option value="#f5d7b6">浅色</option>
                    <option value="#eac096">中等</option>
                    <option value="#d8a46c">健康小麦</option>
                    <option value="#c7875f">深色</option>
                </select>
            </label>
            <label>
                发型:
                <select id="charHairStyle">
                    <option value="short">短发</option>
                    <option value="medium">中长发</option>
                    <option value="long">长发</option>
                    <option value="bun">丸子头</option>
                    <option value="crewcut">板寸</option>
                </select>
            </label>
            <label>
                发色:
                <select id="charHairColor">
                    <option value="#000">黑色</option>
                    <option value="#654321">棕色</option>
                    <option value="#aaa">灰白</option>
                    <option value="#e66465">红棕</option>
                    <option value="#5a5aad">蓝黑</option>
                </select>
            </label>
            <label>
                眼睛大小:
                <input type="range" id="charEyeSize" min="80" max="120" value="100"/>
            </label>
            <label>
                鼻子长度:
                <input type="range" id="charNoseLength" min="80" max="120" value="100"/>
            </label>
            <label>
                嘴巴弧度:
                <input type="range" id="charMouthCurve" min="80" max="120" value="100"/>
            </label>
        </div>

        <div class="option-group">
            <h3>服饰定制</h3>
            <label>
                上装:
                <select id="charTop">
                    <option value="t-shirt">T恤</option>
                    <option value="shirt">衬衫</option>
                    <option value="jacket">夹克</option>
                    <option value="robe">长袍</option>
                </select>
            </label>
            <label>
                下装:
                <select id="charBottom">
                    <option value="jeans">牛仔裤</option>
                    <option value="trousers">休闲裤</option>
                    <option value="shorts">短裤</option>
                    <option value="hakama">和服裤</option>
                </select>
            </label>
            <label>
                鞋子:
                <select id="charShoes">
                    <option value="sneakers">运动鞋</option>
                    <option value="boots">靴子</option>
                    <option value="sandals">凉鞋</option>
                    <option value="loafers">乐福鞋</option>
                </select>
            </label>
            <label>
                服装颜色:
                <select id="charClothColor">
                    <option value="#ffffff">白色</option>
                    <option value="#000000">黑色</option>
                    <option value="#3c93e6">蓝色</option>
                    <option value="#d14f4f">红色</option>
                    <option value="#4fd175">绿色</option>
                </select>
            </label>
        </div>

        <div class="option-group">
            <h3>个性与技能</h3>
            <label>
                个性标签(用逗号分隔):
                <input type="text" id="charTraits" placeholder="如：勇敢, 谨慎, 幽默"/>
            </label>
            <label>
                背景故事:
                <textarea id="charBackstory" rows="4" placeholder="为张弛撰写一段背景故事..."></textarea>
            </label>
            <h3>技能点分配</h3>
            <label>力量:
                <input type="range" id="charStrength" min="0" max="10" value="5"/>
            </label>
            <label>智力:
                <input type="range" id="charIntelligence" min="0" max="10" value="5"/>
            </label>
            <label>敏捷:
                <input type="range" id="charAgility" min="0" max="10" value="5"/>
            </label>
            <label>魅力:
                <input type="range" id="charCharisma" min="0" max="10" value="5"/>
            </label>
        </div>

        <div class="option-group">
            <button id="saveCharacter">保存角色配置</button>
            <button id="resetCharacter">重置配置</button>
        </div>
    </div>

    <!-- 中间场景与底部状态栏 -->
    <div class="main-area">
        <div class="top-bar">
            <div class="logo">张弛的世界</div>
            <div class="actions">
                <button id="enterStoryMode">进入剧情模式</button>
                <button id="enterBattleMode">进入战斗模式</button>
                <button id="enterFreeMode">自由探索</button>
            </div>
        </div>
        <div class="scene">
            <div class="character-preview" id="characterPreview">
                <!-- 虚拟形象的各层部件（这里简单以纯色块示例，可根据实际需求更换为图片） -->
                <div class="character-part" id="skinLayer"></div>
                <div class="character-part" id="hairLayer"></div>
                <div class="character-part" id="faceLayer"></div>
                <div class="character-part" id="topLayer"></div>
                <div class="character-part" id="bottomLayer"></div>
                <div class="character-part" id="shoesLayer"></div>
            </div>
        </div>
        <div class="status-bar">
            <div class="status-item">
                <h4>力量</h4>
                <div class="status-value" id="statStrength">5</div>
            </div>
            <div class="status-item">
                <h4>智力</h4>
                <div class="status-value" id="statIntelligence">5</div>
            </div>
            <div class="status-item">
                <h4>敏捷</h4>
                <div class="status-value" id="statAgility">5</div>
            </div>
            <div class="status-item">
                <h4>魅力</h4>
                <div class="status-value" id="statCharisma">5</div>
            </div>
        </div>
    </div>
</div>

<script>
    // 数据模型
    let characterData = {
        name: "张弛",
        nickname: "",
        age: 25,
        height: 175,
        weight: 68,
        skinColor: "#f5d7b6",
        hairStyle: "short",
        hairColor: "#000",
        eyeSize: 100,
        noseLength: 100,
        mouthCurve: 100,
        top: "t-shirt",
        bottom: "jeans",
        shoes: "sneakers",
        clothColor: "#ffffff",
        traits: "",
        backstory: "",
        strength: 5,
        intelligence: 5,
        agility: 5,
        charisma: 5
    };

    const preview = document.getElementById("characterPreview");
    const skinLayer = document.getElementById("skinLayer");
    const hairLayer = document.getElementById("hairLayer");
    const faceLayer = document.getElementById("faceLayer");
    const topLayer = document.getElementById("topLayer");
    const bottomLayer = document.getElementById("bottomLayer");
    const shoesLayer = document.getElementById("shoesLayer");

    // 简化处理，这里只是用颜色块和简单变形来模拟不同特征
    function updateCharacterView() {
        // 肤色层
        skinLayer.style.background = characterData.skinColor;

        // 发型与颜色（此处简单用颜色条模拟发型顶部）
        // 不同发型显示不同形状，例如：
        // short: 一个上方的矩形
        // medium: 一个稍长的半圆模拟
        // long: 更长的矩形
        // bun: 顶部一个圆形等
        let hairShape = "";
        let hairGradient = `linear-gradient(${characterData.hairColor}, ${characterData.hairColor})`;

        switch(characterData.hairStyle) {
            case "short":
                hairLayer.style.background = hairGradient;
                hairLayer.style.clipPath = "ellipse(80% 20% at 50% 0%)";
                break;
            case "medium":
                hairLayer.style.background = hairGradient;
                hairLayer.style.clipPath = "ellipse(80% 30% at 50% 0%)";
                break;
            case "long":
                hairLayer.style.background = hairGradient;
                hairLayer.style.clipPath = "ellipse(80% 40% at 50% 0%)";
                break;
            case "bun":
                hairLayer.style.background = hairGradient;
                hairLayer.style.clipPath = "circle(40px at 50% 15%)";
                break;
            case "crewcut":
                hairLayer.style.background = hairGradient;
                hairLayer.style.clipPath = "ellipse(80% 10% at 50% 0%)";
                break;
        }

        // 面部特征（眼睛大小、鼻子长度、嘴巴弧度）
        // 简化为用渐变和遮罩模拟不同的面部特征
        // 假设眼睛、鼻子、嘴巴都是用不同clipPath模拟的形状
        // 实际中可用svg或者图像叠加
        faceLayer.innerHTML = "";
        faceLayer.style.background = "none";
        const faceCanvas = document.createElement("canvas");
        faceCanvas.width = 300;
        faceCanvas.height = 600;
        const ctx = faceCanvas.getContext("2d");

        // 画脸部特征：眼睛（两个椭圆）
        let eyeWidth = 20 * (characterData.eyeSize / 100);
        let eyeHeight = 10 * (characterData.eyeSize / 100);
        let noseHeight = 30 * (characterData.noseLength / 100);
        let mouthCurve = (characterData.mouthCurve - 100) * 0.5; // 正负来控制嘴巴的弧度

        ctx.fillStyle = "#000";

        // 眼睛位置：略上
        ctx.beginPath();
        ctx.ellipse(150 - 30, 200, eyeWidth, eyeHeight, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.beginPath();
        ctx.ellipse(150 + 30, 200, eyeWidth, eyeHeight, 0, 0, Math.PI * 2);
        ctx.fill();

        // 鼻子(一个简单的矩形代表)
        ctx.fillRect(150 - 2, 220, 4, noseHeight);

        // 嘴巴(一条弧线)
        ctx.beginPath();
        ctx.strokeStyle = "#000";
        ctx.lineWidth = 2;
        ctx.arc(150, 280, 20, Math.PI * (0.2 + mouthCurve/100), Math.PI * (0.8 - mouthCurve/100), false);
        ctx.stroke();

        faceLayer.style.background = `url(${faceCanvas.toDataURL()}) center/cover`;

        // 服装层
        // 用纯色块模拟，上下分区域
        topLayer.style.background = characterData.clothColor;
        bottomLayer.style.background = characterData.clothColor;
        shoesLayer.style.background = characterData.clothColor;

        // 根据服饰类型稍微调整clipPath区域，简单模拟不同服饰轮廓
        switch(characterData.top) {
            case "t-shirt":
                topLayer.style.clipPath = "polygon(20% 0%,80% 0%,90% 50%,10% 50%)";
                break;
            case "shirt":
                topLayer.style.clipPath = "polygon(20% 0%,80% 0%,90% 55%,10% 55%)";
                break;
            case "jacket":
                topLayer.style.clipPath = "polygon(20% 0%,80% 0%,100% 60%,0% 60%)";
                break;
            case "robe":
                topLayer.style.clipPath = "polygon(30% 0%,70% 0%,90% 70%,10% 70%)";
                break;
        }

        switch(characterData.bottom) {
            case "jeans":
                bottomLayer.style.clipPath = "polygon(20% 50%,80% 50%,80% 100%,20% 100%)";
                break;
            case "trousers":
                bottomLayer.style.clipPath = "polygon(20% 55%,80% 55%,80% 100%,20% 100%)";
                break;
            case "shorts":
                bottomLayer.style.clipPath = "polygon(25% 50%,75% 50%,75% 70%,25% 70%)";
                break;
            case "hakama":
                bottomLayer.style.clipPath = "polygon(20% 50%,80% 50%,90% 100%,10% 100%)";
                break;
        }

        switch(characterData.shoes) {
            case "sneakers":
                shoesLayer.style.clipPath = "polygon(20% 90%,80% 90%,75% 100%,25% 100%)";
                break;
            case "boots":
                shoesLayer.style.clipPath = "polygon(20% 85%,80% 85%,85% 100%,15% 100%)";
                break;
            case "sandals":
                shoesLayer.style.clipPath = "polygon(25% 95%,75% 95%,70% 100%,30% 100%)";
                break;
            case "loafers":
                shoesLayer.style.clipPath = "polygon(20% 92%,80% 92%,70% 100%,30% 100%)";
                break;
        }

        // 更新状态条
        document.getElementById("statStrength").textContent = characterData.strength;
        document.getElementById("statIntelligence").textContent = characterData.intelligence;
        document.getElementById("statAgility").textContent = characterData.agility;
        document.getElementById("statCharisma").textContent = characterData.charisma;
    }

    function loadFromInputs() {
        characterData.nickname = document.getElementById("charNickname").value;
        characterData.age = parseInt(document.getElementById("charAge").value,10);
        characterData.height = parseInt(document.getElementById("charHeight").value,10);
        characterData.weight = parseInt(document.getElementById("charWeight").value,10);
        characterData.skinColor = document.getElementById("charSkinColor").value;
        characterData.hairStyle = document.getElementById("charHairStyle").value;
        characterData.hairColor = document.getElementById("charHairColor").value;
        characterData.eyeSize = parseInt(document.getElementById("charEyeSize").value,10);
        characterData.noseLength = parseInt(document.getElementById("charNoseLength").value,10);
        characterData.mouthCurve = parseInt(document.getElementById("charMouthCurve").value,10);
        characterData.top = document.getElementById("charTop").value;
        characterData.bottom = document.getElementById("charBottom").value;
        characterData.shoes = document.getElementById("charShoes").value;
        characterData.clothColor = document.getElementById("charClothColor").value;
        characterData.traits = document.getElementById("charTraits").value;
        characterData.backstory = document.getElementById("charBackstory").value;
        characterData.strength = parseInt(document.getElementById("charStrength").value,10);
        characterData.intelligence = parseInt(document.getElementById("charIntelligence").value,10);
        characterData.agility = parseInt(document.getElementById("charAgility").value,10);
        characterData.charisma = parseInt(document.getElementById("charCharisma").value,10);
    }

    function resetCharacter() {
        // 重置为初始值
        characterData = {
            name: "张弛",
            nickname: "",
            age: 25,
            height: 175,
            weight: 68,
            skinColor: "#f5d7b6",
            hairStyle: "short",
            hairColor: "#000",
            eyeSize: 100,
            noseLength: 100,
            mouthCurve: 100,
            top: "t-shirt",
            bottom: "jeans",
            shoes: "sneakers",
            clothColor: "#ffffff",
            traits: "",
            backstory: "",
            strength: 5,
            intelligence: 5,
            agility: 5,
            charisma: 5
        };

        // 更新表单
        document.getElementById("charNickname").value = characterData.nickname;
        document.getElementById("charAge").value = characterData.age;
        document.getElementById("charHeight").value = characterData.height;
        document.getElementById("charWeight").value = characterData.weight;
        document.getElementById("charSkinColor").value = characterData.skinColor;
        document.getElementById("charHairStyle").value = characterData.hairStyle;
        document.getElementById("charHairColor").value = characterData.hairColor;
        document.getElementById("charEyeSize").value = characterData.eyeSize;
        document.getElementById("charNoseLength").value = characterData.noseLength;
        document.getElementById("charMouthCurve").value = characterData.mouthCurve;
        document.getElementById("charTop").value = characterData.top;
        document.getElementById("charBottom").value = characterData.bottom;
        document.getElementById("charShoes").value = characterData.shoes;
        document.getElementById("charClothColor").value = characterData.clothColor;
        document.getElementById("charTraits").value = characterData.traits;
        document.getElementById("charBackstory").value = characterData.backstory;
        document.getElementById("charStrength").value = characterData.strength;
        document.getElementById("charIntelligence").value = characterData.intelligence;
        document.getElementById("charAgility").value = characterData.agility;
        document.getElementById("charCharisma").value = characterData.charisma;

        updateCharacterView();
    }

    // 事件绑定
    document.getElementById("saveCharacter").addEventListener("click", function() {
        loadFromInputs();
        updateCharacterView();
        alert("角色配置已保存！");
    });

    document.getElementById("resetCharacter").addEventListener("click", function() {
        if(confirm("确定要重置吗？将恢复初始状态。")) {
            resetCharacter();
        }
    });

    // 模式切换（简单的提示示例）
    document.getElementById("enterStoryMode").addEventListener("click", function() {
        alert("进入剧情模式：探索张弛的故事与背景世界...");
    });
    document.getElementById("enterBattleMode").addEventListener("click", function() {
        alert("进入战斗模式：张弛将面对各种敌人，提升技能属性以战胜他们！");
    });
    document.getElementById("enterFreeMode").addEventListener("click", function() {
        alert("进入自由探索模式：随心所欲地在世界中行走，体验各种事件。");
    });

    // 初始化
    updateCharacterView();
</script>

</body>
</html>
